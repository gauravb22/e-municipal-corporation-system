<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Complaint Form | E-Municipal Corporation</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{
    margin:0;
    font-family:"Segoe UI", Arial;
    background:
      radial-gradient(circle at top left, #2a5298, transparent 40%),
      radial-gradient(circle at bottom right, #1e3c72, transparent 40%),
      linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    min-height:100vh;
}

/* TOP BAR */
.topbar{
    background:#0f2442;
    color:white;
    padding:14px 18px;
    display:flex;
    gap:12px;
    align-items:center;
}
.topbar i{ cursor:pointer; }

/* CONTAINER */
.container{
    max-width:520px;
    margin:26px auto;
    padding:12px;
}

.card{
    background:white;
    border-radius:20px;
    padding:24px;
    box-shadow:0 20px 40px rgba(0,0,0,.35);
}

/* FORM */
label{
    display:block;
    margin-top:14px;
    font-weight:600;
}

input, textarea{
    width:100%;
    padding:12px;
    margin-top:6px;
    border-radius:12px;
    border:1px solid #ccc;
    font-size:14px;
}
textarea{
    resize:none;
    height:110px;
}

/* CAMERA */
.camera-box{
    border:2px dashed #1e3c72;
    border-radius:14px;
    padding:18px;
    text-align:center;
    margin-top:10px;
}
.camera-box i{
    font-size:28px;
    color:#1e3c72;
}

/* INFO */
.info{
    background:#f4f6f7;
    border-radius:12px;
    padding:12px;
    margin-top:14px;
    font-size:14px;
}

/* BUTTON */
button{
    width:100%;
    margin-top:18px;
    padding:14px;
    border:none;
    border-radius:14px;
    font-size:16px;
    font-weight:600;
    color:white;
    background:linear-gradient(135deg,#1e3c72,#2a5298);
    cursor:pointer;
}
button:disabled{
    background:#95a5a6;
    cursor:not-allowed;
}

small{
    display:block;
    margin-top:10px;
    color:#555;
}
</style>
</head>

<body>

<!-- TOP BAR -->
<div class="topbar">
    <i class="fa-solid fa-arrow-left" onclick="history.back()"></i>
    <strong id="title">Complaint Form</strong>
</div>

<div class="container">
<div class="card">

<!-- ADDRESS -->
<label>Address / Landmark *</label>
<input type="text" id="address" placeholder="Near school, temple, main road" required>

<!-- HOUSE NUMBER -->
<label>Nearby House Number *</label>
<input type="text" id="house" placeholder="House / Shop number" required>

<!-- DESCRIPTION -->
<label>Complaint Description *</label>
<textarea id="desc" placeholder="Explain the issue clearly" required></textarea>

<!-- CAMERA ONLY -->
<label>Complaint Photo (Live Camera Only) *</label>
<div class="camera-box">
    <i class="fa-solid fa-camera"></i>
    <p>Camera will open (Gallery not allowed)</p>

    <input type="file"
           id="photo"
           accept="image/*"
           capture="environment"
           required>
</div>

<!-- LOCATION + TIME -->
<div class="info">
    <strong>Live Details:</strong><br>
    üìç Location: <span id="location">Fetching...</span><br>
    üïí Timestamp: <span id="time">Fetching...</span>
</div>

<button id="submitBtn" disabled onclick="submitComplaint()">
    Submit Complaint
</button>

<small>
All fields are mandatory. Complaint requires live camera photo with GPS & timestamp.
</small>

</div>
</div>

<script>
// Show complaint type from URL
const params = new URLSearchParams(window.location.search);
if(params.get("type")){
    document.getElementById("title").innerText =
        params.get("type") + " Complaint";
}

// LOCATION
navigator.geolocation.getCurrentPosition(
    pos => {
        document.getElementById("location").innerText =
          `${pos.coords.latitude}, ${pos.coords.longitude}`;
        checkForm();
    },
    () => {
        alert("Location permission is required");
    }
);

// TIMESTAMP
const now = new Date();
document.getElementById("time").innerText = now.toLocaleString();

// FORM VALIDATION
document.querySelectorAll("input, textarea").forEach(el=>{
    el.addEventListener("input", checkForm);
});

function checkForm(){
    const filled =
        address.value &&
        house.value &&
        desc.value &&
        photo.files.length > 0 &&
        document.getElementById("location").innerText !== "Fetching...";
    document.getElementById("submitBtn").disabled = !filled;
}

function submitComplaint(){
    alert("Complaint submitted successfully (frontend demo)");
}
</script>

</body>
</html>
