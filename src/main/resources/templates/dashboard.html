<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>E-Municipal Corporation | Dashboard</title>

<!-- Font Awesome Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">


    <link rel="stylesheet" href="/css/dashboard.css">
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">
    <h3>Menu</h3>
    <a href="/my-profile"><i class="fa-solid fa-user"></i>My Profile</a>
    <a href="/raise-complaint"><i class="fa-solid fa-file-circle-plus"></i>Raise Complaint</a>
    <a href="/complaint-status"><i class="fa-solid fa-chart-line"></i>Complaint Status</a>
    <a href="/works-yojna"><i class="fa-solid fa-city"></i>Works / Yojna</a>
    <a href="/citizen/ward-works"><i class="fa-solid fa-person-digging"></i>Your Ward Works</a>
    <a href="/logout" class="logout"><i class="fa-solid fa-right-from-bracket"></i>Logout</a>
</div>
<div class="overlay" id="overlay" onclick="toggleMenu()"></div>

<!-- TOP BAR -->
<div class="topbar">
    <div class="topbar-left">
        <img src="/images/municipalLogo.png" alt="Logo">
        <div>
            <strong>E-Municipal Corporation</strong><br>
            <small>Akola Mahanagarpalika</small>
        </div>
    </div>
    <div class="topbar-right">
        <div class="notification-wrap">
            <button type="button" class="bell-btn" id="notifBell" onclick="toggleNotifications(event)">
                <i class="fa-regular fa-bell"></i>
                <span class="notif-badge"
                      th:if="${unreadNotificationCount != null && unreadNotificationCount > 0}"
                      th:text="${unreadNotificationCount > 99 ? '99+' : unreadNotificationCount}">1</span>
            </button>
            <div class="notif-panel" id="notifPanel">
                <div class="notif-head">
                    <span>Notifications</span>
                    <form method="post"
                          action="/citizen/notifications/read-all"
                          th:if="${recentNotifications != null && !recentNotifications.isEmpty()}">
                        <input type="hidden" name="redirect" value="/dashboard">
                        <button type="submit" class="notif-markall">Mark all read</button>
                    </form>
                </div>
                <div class="notif-list" th:if="${recentNotifications != null && !recentNotifications.isEmpty()}">
                    <a class="notif-item"
                       th:each="n : ${recentNotifications}"
                       th:classappend="${n.readFlag != null && !n.readFlag} ? ' unread' : ''"
                       th:href="@{/citizen/notifications/{id}/open(id=${n.id})}">
                        <div class="notif-title" th:text="${n.title}">Notification</div>
                        <div class="notif-msg" th:text="${n.message}">Message</div>
                        <div class="notif-time"
                             th:text="${n.createdAt != null ? #temporals.format(n.createdAt, 'dd-MMM-yyyy HH:mm') : ''}">Time</div>
                    </a>
                </div>
                <div class="notif-empty" th:if="${recentNotifications == null || recentNotifications.isEmpty()}">
                    No notifications yet.
                </div>
            </div>
        </div>
        <div class="menu-btn" onclick="toggleMenu()">
            <i class="fa-solid fa-bars"></i>
        </div>
    </div>
</div>

<!-- ALERT -->
<div class="alert-bar">
    <div class="alert-text" id="alerts">
        <span th:if="${citizenNotices != null && !citizenNotices.isEmpty()}" th:each="n : ${citizenNotices}" th:text="${n.message}"></span>
        <span th:if="${citizenNotices == null || citizenNotices.isEmpty()}">No new notices from administration.</span>
    </div>
</div>

<div class="toast" id="complaintToast" th:if="${complaintSubmitted}">
    Complaint submitted
    <small>We have received your complaint.</small>
</div>

<!-- CONTENT -->
<div class="container">

    <div class="section-title">Citizen Services</div>

    <div class="grid">
        <a href="/raise-complaint" style="text-decoration:none; color:inherit;">
            <div class="card action-card">
             <div class="icon-box"><i class="fa-solid fa-pen-to-square"></i></div>
                <h3>Raise Complaint</h3>
                <p>Submit civic issues online</p>
            </div>
        </a>

       <a href="/complaint-status" style="text-decoration:none;color:inherit;">
            <div class="card action-card">
                <div class="icon-box">
                    <i class="fa-solid fa-magnifying-glass-chart"></i>
                </div>
                <h3>Complaint Status</h3>
                <p>Track complaint progress</p>
            </div>
        </a>

        <a href="/my-profile" style="text-decoration:none;color:inherit;">
            <div class="card action-card">
                <div class="icon-box"><i class="fa-solid fa-id-card"></i></div>
                <h3>My Profile</h3>
                <p>View or update details</p>
            </div>
        </a>

        <a href="/works-yojna" style="text-decoration:none;color:inherit;">
            <div class="card action-card">
                <div class="icon-box"><i class="fa-solid fa-road"></i></div>
                <h3>Works / Yojana</h3>
                <p>Municipal projects</p>
            </div>
        </a>
    </div>

    <div class="section-title">Important Notices</div>

    <div class="card notice">
        <ul th:if="${citizenNotices != null && !citizenNotices.isEmpty()}">
            <li th:each="n : ${citizenNotices}" th:text="${n.message}"></li>
        </ul>
        <ul th:if="${citizenNotices == null || citizenNotices.isEmpty()}">
            <li>No notices available right now.</li>
        </ul>
    </div>

    <div class="section-title">Pending Feedback</div>

    <div class="card" th:if="${pendingFeedback != null && !pendingFeedback.isEmpty()}">
        <p style="margin:0 0 10px;color:#1e3c72;font-weight:600;">
            Please submit feedback for completed complaints.
        </p>
        <div th:each="c : ${pendingFeedback}" style="padding:10px;border:1px solid #e7e7e7;border-radius:12px;margin-bottom:10px;">
            <div style="font-weight:700;color:#0f2442;" th:text="${c.complaintType}">Complaint Type</div>
            <div style="color:#5c6674;font-size:13px;margin-top:4px;">
                Completed on
                <span th:text="${c.updatedAt != null ? #temporals.format(c.updatedAt, 'dd-MMM-yyyy HH:mm') : #temporals.format(c.createdAt, 'dd-MMM-yyyy HH:mm')}"></span>
            </div>
            <a href="/complaint-status" style="display:inline-block;margin-top:8px;background:#1e3c72;color:white;text-decoration:none;padding:8px 12px;border-radius:10px;font-size:12px;font-weight:600;">
                Submit Feedback
            </a>
        </div>
    </div>
    <div class="card" th:if="${pendingFeedback == null || pendingFeedback.isEmpty()}">
        <p style="margin:0;color:#5c6674;">No pending feedback. Thank you for your response.</p>
    </div>

    <div class="section-title">Municipal Administration</div>

    <div class="card">
        <div class="admin-slider" id="adminSlider">
            <div class="admin-title" id="adminRole">Municipal Commissioner</div>
            <div class="admin-name" id="adminName">Shri __________</div>
            <div class="admin-desc" id="adminDesc">City administration and civic service oversight.</div>
            <img class="admin-photo" id="adminPhoto" src="images/commissioner.jpg" alt="Municipal Commissioner">
            <div class="admin-slide-indicator" id="adminIndicator">1 / 3</div>
        </div>
    </div>

</div>

<!-- FOOTER -->
<footer class="footer">
    <div class="footer-container">
        <div class="footer-section">
            <h4>E-Municipal Corporation</h4>
            <p>Akola Mahanagarpalika</p>
            <p>Digital governance for transparent civic services</p>
        </div>
        <div class="footer-section">
            <h4>Contact</h4>
            <p>Helpline: 1800-XXX-XXXX</p>
            <p>Email: support@akolamc.gov.in</p>
        </div>
        <div class="footer-section">
            <h4>Office Address</h4>
            <p>Akola Municipal Corporation</p>
            <p>Near Collector Office, Akola, Maharashtra</p>
        </div>
    </div>
    <div class="footer-bottom">
        Â© 2026 Akola Municipal Corporation | Developed by Gaurav Bulbule
    </div>
</footer>



    <script src="/js/dashboard.js"></script>
</body>
</html>

