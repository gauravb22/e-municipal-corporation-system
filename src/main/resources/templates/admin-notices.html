<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Admin Notice Center</title>

    <link rel="stylesheet" href="/css/admin-notices.css">
</head>
<body>
<div class="layout">
    <aside class="sidebar">
        <div class="sidebar-title">Admin Panel</div>
        <a class="nav-link" href="/admin-dashboard">Dashboard</a>
        <a class="nav-link" href="/admin/users">View Citizens</a>
        <a class="nav-link" href="/admin/ward-members">Ward Members</a>
        <a class="nav-link" href="/admin/ward-reports">Ward Reports</a>
        <a class="nav-link" href="/admin/ward-works">Ward Works Feed</a>
        <a class="nav-link" href="/admin/notices">Notice Center</a>
    </aside>
    <div class="content">
        <div class="topbar">
            <div class="brand">
                <img src="/images/municipalLogo.png" alt="Municipal Logo">
                <div>
                    <div class="brand-title">Akola Mahanagarpalika</div>
                    <div class="brand-sub">Admin Notice Center</div>
                </div>
            </div>
            <div class="topbar-actions">
                <a class="topbar-link" href="/admin-dashboard">Back to Dashboard</a>
                <a class="topbar-link" href="/logout">Logout</a>
            </div>
        </div>

        <div class="container">
            <div class="title">Publish Notices</div>
            <div class="notice-grid">
                <div class="card notice-card">
            <div class="label">Notice For Citizens</div>
            <form class="notice-form" method="post" action="/admin/notices/citizen">
                <textarea name="noticeMessage" placeholder="Write citizen notice..." required></textarea>
                <button class="btn" type="submit">Publish Citizen Notice</button>
            </form>
            <div class="notice-list" id="citizen-notices" th:if="${citizenNotices != null && !citizenNotices.isEmpty()}">
                <div class="notice-item"
                     th:each="n,stat : ${citizenNotices}"
                     th:classappend="${stat.index >= 5} ? ' notice-old notice-hidden' : ''">
                    <div th:text="${n.message}">Notice</div>
                    <div class="notice-meta" th:text="${(n.createdBy != null ? n.createdBy : 'admin') + ' | ' + #temporals.format(n.createdAt, 'dd-MMM-yyyy HH:mm')}"></div>
                    <form class="notice-actions" method="post" th:action="@{/admin/notices/{id}/delete(id=${n.id})}">
                        <button class="delete-btn" type="submit">Delete Notice</button>
                    </form>
                </div>
            </div>
            <button class="toggle-btn"
                    type="button"
                    th:if="${citizenNotices != null && citizenNotices.size() > 5}"
                    onclick="togglePreviousNotices('citizen-notices', this)">
                Show Previous Notices
            </button>
            <div class="empty-notice" th:if="${citizenNotices == null || citizenNotices.isEmpty()}">No notices published yet.</div>
        </div>

                <div class="card notice-card">
            <div class="label">Notice For Ward Members</div>
            <form class="notice-form" method="post" action="/admin/notices/ward">
                <textarea name="noticeMessage" placeholder="Write ward member notice..." required></textarea>
                <button class="btn" type="submit">Publish Ward Notice</button>
            </form>
            <div class="notice-list" id="ward-notices" th:if="${wardNotices != null && !wardNotices.isEmpty()}">
                <div class="notice-item"
                     th:each="n,stat : ${wardNotices}"
                     th:classappend="${stat.index >= 5} ? ' notice-old notice-hidden' : ''">
                    <div th:text="${n.message}">Notice</div>
                    <div class="notice-meta" th:text="${(n.createdBy != null ? n.createdBy : 'admin') + ' | ' + #temporals.format(n.createdAt, 'dd-MMM-yyyy HH:mm')}"></div>
                    <form class="notice-actions" method="post" th:action="@{/admin/notices/{id}/delete(id=${n.id})}">
                        <button class="delete-btn" type="submit">Delete Notice</button>
                    </form>
                </div>
            </div>
            <button class="toggle-btn"
                    type="button"
                    th:if="${wardNotices != null && wardNotices.size() > 5}"
                    onclick="togglePreviousNotices('ward-notices', this)">
                Show Previous Notices
            </button>
            <div class="empty-notice" th:if="${wardNotices == null || wardNotices.isEmpty()}">No notices published yet.</div>
        </div>
            </div>
        </div>
    </div>
</div>


    <script src="/js/admin-notices.js"></script>
</body>
</html>

