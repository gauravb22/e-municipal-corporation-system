<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Manage Works & Yojna</title>
<style>
body{
    margin:0;
    font-family:"Segoe UI", Arial, sans-serif;
    background:linear-gradient(135deg,#2b1a0f,#9b5a13);
    min-height:100vh;
}
.topbar{
    background:#4a2811;
    color:#fff;
    padding:12px 16px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    flex-wrap:wrap;
}
.brand{
    display:flex;
    align-items:center;
    gap:10px;
}
.brand img{
    width:40px;
    height:40px;
    object-fit:contain;
}
.brand-title{
    font-weight:700;
}
.brand-sub{
    font-size:12px;
    opacity:.86;
    margin-top:2px;
}
.top-actions{
    display:flex;
    gap:14px;
    align-items:center;
}
.top-link{
    color:#fff;
    text-decoration:none;
    font-size:14px;
}
.container{
    max-width:1150px;
    margin:22px auto;
    padding:0 12px 24px;
}
.page-title{
    color:#fff;
    margin:0 0 8px;
    font-size:24px;
}
.page-sub{
    color:rgba(255,255,255,.9);
    font-size:13px;
    margin:0 0 16px;
}
.alert{
    border-radius:10px;
    padding:10px 12px;
    font-size:13px;
    font-weight:600;
    margin-bottom:12px;
}
.alert.success{
    background:#d1fadf;
    color:#065f46;
}
.alert.error{
    background:#ffe2e0;
    color:#9b1c1c;
}
.card{
    background:#fff;
    border-radius:16px;
    padding:16px;
    box-shadow:0 10px 24px rgba(0,0,0,.2);
}
.form-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:10px;
}
.field-label{
    font-size:12px;
    color:#7b5b45;
    margin-bottom:6px;
}
.field{
    width:100%;
    border:1px solid #e2d4c5;
    border-radius:10px;
    padding:10px;
    font-family:"Segoe UI", Arial, sans-serif;
    font-size:14px;
}
textarea.field{
    min-height:100px;
    resize:vertical;
}
.btn-row{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    margin-top:12px;
}
.btn{
    border:none;
    border-radius:10px;
    padding:10px 14px;
    font-weight:700;
    cursor:pointer;
    font-size:13px;
}
.btn.primary{
    background:#7a3e0b;
    color:#fff;
}
.btn.danger{
    background:#b42318;
    color:#fff;
}
.section{
    margin-top:16px;
}
.section-title{
    color:#fff;
    font-size:20px;
    margin:0 0 10px;
}
.entry-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(360px,1fr));
    gap:12px;
}
.meta-line{
    font-size:12px;
    color:#7b5b45;
    margin-bottom:10px;
}
.empty{
    background:#fff8f1;
    border:1px dashed #d9bfa7;
    border-radius:10px;
    color:#7b5b45;
    font-size:13px;
    padding:12px;
}
@media (max-width:700px){
    .entry-grid{
        grid-template-columns:1fr;
    }
}
</style>
</head>
<body>
<div class="topbar">
    <div class="brand">
        <img src="/images/municipalLogo.png" alt="Municipal Logo">
        <div>
            <div class="brand-title">Akola Mahanagarpalika</div>
            <div class="brand-sub">Works / Yojna Management</div>
        </div>
    </div>
    <div class="top-actions">
        <a class="top-link" href="/admin-dashboard">Dashboard</a>
        <a class="top-link" href="/logout">Logout</a>
    </div>
</div>

<div class="container">
    <h1 class="page-title">Manage Citizen Works & Yojna</h1>
    <p class="page-sub">Add new cards and update or delete existing cards shown on the citizen Works / Yojna page.</p>

    <div class="alert success" th:if="${param.created}">Entry added successfully.</div>
    <div class="alert success" th:if="${param.updated}">Entry updated successfully.</div>
    <div class="alert success" th:if="${param.deleted}">Entry deleted successfully.</div>
    <div class="alert error" th:if="${param.error != null and param.error[0] == 'title'}">Title is required.</div>
    <div class="alert error" th:if="${param.error != null and param.error[0] == 'notfound'}">Entry not found.</div>

    <div class="card">
        <form method="post" action="/admin/works-yojna/create">
            <div class="form-grid">
                <div>
                    <div class="field-label">Section</div>
                    <select class="field" name="sectionType" required>
                        <option value="WORK">Municipal Work</option>
                        <option value="YOJNA">Government Yojna</option>
                    </select>
                </div>
                <div>
                    <div class="field-label">Title</div>
                    <input class="field" type="text" name="title" maxlength="200" required>
                </div>
                <div>
                    <div class="field-label">Status Label</div>
                    <input class="field" type="text" name="statusLabel" maxlength="40" placeholder="Ongoing / Completed / Active">
                </div>
                <div>
                    <div class="field-label">Meta Line 1</div>
                    <input class="field" type="text" name="metaOne" maxlength="250" placeholder="Ward 5 / Citizens">
                </div>
                <div>
                    <div class="field-label">Meta Line 2</div>
                    <input class="field" type="text" name="metaTwo" maxlength="250" placeholder="Jan-Mar 2026 / Department">
                </div>
                <div>
                    <div class="field-label">Button Text</div>
                    <input class="field" type="text" name="actionText" maxlength="120" placeholder="View Details / Apply">
                </div>
                <div>
                    <div class="field-label">Button Link (optional)</div>
                    <input class="field" type="url" name="actionUrl" maxlength="500" placeholder="https://...">
                </div>
                <div style="grid-column:1/-1;">
                    <div class="field-label">Description</div>
                    <textarea class="field" name="description" maxlength="4000" placeholder="Describe this work or yojna"></textarea>
                </div>
            </div>
            <div class="btn-row">
                <button class="btn primary" type="submit">Add Entry</button>
            </div>
        </form>
    </div>

    <div class="section">
        <h2 class="section-title">Municipal Works</h2>
        <div class="empty" th:if="${workItems == null || workItems.isEmpty()}">No work entries added yet.</div>
        <div class="entry-grid" th:if="${workItems != null && !workItems.isEmpty()}">
            <div class="card" th:each="item : ${workItems}">
                <div class="meta-line" th:text="${'Created: ' + #temporals.format(item.createdAt, 'dd-MMM-yyyy HH:mm')}">Created</div>
                <form method="post" th:action="@{/admin/works-yojna/{id}/update(id=${item.id})}">
                    <div class="form-grid">
                        <div>
                            <div class="field-label">Section</div>
                            <select class="field" name="sectionType" required>
                                <option value="WORK" th:selected="${item.sectionType == 'WORK'}">Municipal Work</option>
                                <option value="YOJNA" th:selected="${item.sectionType == 'YOJNA'}">Government Yojna</option>
                            </select>
                        </div>
                        <div>
                            <div class="field-label">Title</div>
                            <input class="field" type="text" name="title" maxlength="200" th:value="${item.title}" required>
                        </div>
                        <div>
                            <div class="field-label">Status Label</div>
                            <input class="field" type="text" name="statusLabel" maxlength="40" th:value="${item.statusLabel}">
                        </div>
                        <div>
                            <div class="field-label">Meta Line 1</div>
                            <input class="field" type="text" name="metaOne" maxlength="250" th:value="${item.metaOne}">
                        </div>
                        <div>
                            <div class="field-label">Meta Line 2</div>
                            <input class="field" type="text" name="metaTwo" maxlength="250" th:value="${item.metaTwo}">
                        </div>
                        <div>
                            <div class="field-label">Button Text</div>
                            <input class="field" type="text" name="actionText" maxlength="120" th:value="${item.actionText}">
                        </div>
                        <div>
                            <div class="field-label">Button Link</div>
                            <input class="field" type="url" name="actionUrl" maxlength="500" th:value="${item.actionUrl}">
                        </div>
                        <div style="grid-column:1/-1;">
                            <div class="field-label">Description</div>
                            <textarea class="field" name="description" maxlength="4000" th:text="${item.description}"></textarea>
                        </div>
                    </div>
                    <div class="btn-row">
                        <button class="btn primary" type="submit">Update</button>
                    </div>
                </form>
                <form method="post"
                      th:action="@{/admin/works-yojna/{id}/delete(id=${item.id})}"
                      onsubmit="return confirm('Delete this entry?');">
                    <div class="btn-row">
                        <button class="btn danger" type="submit">Delete</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title">Government Yojna</h2>
        <div class="empty" th:if="${yojnaItems == null || yojnaItems.isEmpty()}">No yojna entries added yet.</div>
        <div class="entry-grid" th:if="${yojnaItems != null && !yojnaItems.isEmpty()}">
            <div class="card" th:each="item : ${yojnaItems}">
                <div class="meta-line" th:text="${'Created: ' + #temporals.format(item.createdAt, 'dd-MMM-yyyy HH:mm')}">Created</div>
                <form method="post" th:action="@{/admin/works-yojna/{id}/update(id=${item.id})}">
                    <div class="form-grid">
                        <div>
                            <div class="field-label">Section</div>
                            <select class="field" name="sectionType" required>
                                <option value="WORK" th:selected="${item.sectionType == 'WORK'}">Municipal Work</option>
                                <option value="YOJNA" th:selected="${item.sectionType == 'YOJNA'}">Government Yojna</option>
                            </select>
                        </div>
                        <div>
                            <div class="field-label">Title</div>
                            <input class="field" type="text" name="title" maxlength="200" th:value="${item.title}" required>
                        </div>
                        <div>
                            <div class="field-label">Status Label</div>
                            <input class="field" type="text" name="statusLabel" maxlength="40" th:value="${item.statusLabel}">
                        </div>
                        <div>
                            <div class="field-label">Meta Line 1</div>
                            <input class="field" type="text" name="metaOne" maxlength="250" th:value="${item.metaOne}">
                        </div>
                        <div>
                            <div class="field-label">Meta Line 2</div>
                            <input class="field" type="text" name="metaTwo" maxlength="250" th:value="${item.metaTwo}">
                        </div>
                        <div>
                            <div class="field-label">Button Text</div>
                            <input class="field" type="text" name="actionText" maxlength="120" th:value="${item.actionText}">
                        </div>
                        <div>
                            <div class="field-label">Button Link</div>
                            <input class="field" type="url" name="actionUrl" maxlength="500" th:value="${item.actionUrl}">
                        </div>
                        <div style="grid-column:1/-1;">
                            <div class="field-label">Description</div>
                            <textarea class="field" name="description" maxlength="4000" th:text="${item.description}"></textarea>
                        </div>
                    </div>
                    <div class="btn-row">
                        <button class="btn primary" type="submit">Update</button>
                    </div>
                </form>
                <form method="post"
                      th:action="@{/admin/works-yojna/{id}/delete(id=${item.id})}"
                      onsubmit="return confirm('Delete this entry?');">
                    <div class="btn-row">
                        <button class="btn danger" type="submit">Delete</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
</body>
</html>
