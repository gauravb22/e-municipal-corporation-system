<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Manage Works & Yojna</title>

    <link rel="stylesheet" href="/css/admin-works-yojna.css">
</head>
<body>
<div class="topbar">
    <div class="brand">
        <img src="/images/municipalLogo.png" alt="Municipal Logo">
        <div>
            <div class="brand-title">Akola Mahanagarpalika</div>
            <div class="brand-sub">Works / Yojna Management</div>
        </div>
    </div>
    <div class="top-actions">
        <a class="top-link" href="/admin-dashboard">Dashboard</a>
        <a class="top-link" href="/logout">Logout</a>
    </div>
</div>

<div class="container">
    <h1 class="page-title">Manage Citizen Works & Yojna</h1>
    <p class="page-sub">Add new cards and update or delete existing cards shown on the citizen Works / Yojna page.</p>

    <div class="alert success" th:if="${param.created}">Entry added successfully.</div>
    <div class="alert success" th:if="${param.updated}">Entry updated successfully.</div>
    <div class="alert success" th:if="${param.deleted}">Entry deleted successfully.</div>
    <div class="alert error" th:if="${param.error != null and param.error[0] == 'title'}">Title is required.</div>
    <div class="alert error" th:if="${param.error != null and param.error[0] == 'notfound'}">Entry not found.</div>

    <div class="card">
        <form method="post" action="/admin/works-yojna/create">
            <div class="form-grid">
                <div>
                    <div class="field-label">Section</div>
                    <select class="field" name="sectionType" required>
                        <option value="WORK">Municipal Work</option>
                        <option value="YOJNA">Government Yojna</option>
                    </select>
                </div>
                <div>
                    <div class="field-label">Title</div>
                    <input class="field" type="text" name="title" maxlength="200" required>
                </div>
                <div>
                    <div class="field-label">Status Label</div>
                    <input class="field" type="text" name="statusLabel" maxlength="40" placeholder="Ongoing / Completed / Active">
                </div>
                <div>
                    <div class="field-label">Meta Line 1</div>
                    <input class="field" type="text" name="metaOne" maxlength="250" placeholder="Ward 5 / Citizens">
                </div>
                <div>
                    <div class="field-label">Meta Line 2</div>
                    <input class="field" type="text" name="metaTwo" maxlength="250" placeholder="Jan-Mar 2026 / Department">
                </div>
                <div>
                    <div class="field-label">Button Text</div>
                    <input class="field" type="text" name="actionText" maxlength="120" placeholder="View Details / Apply">
                </div>
                <div>
                    <div class="field-label">Button Link (optional)</div>
                    <input class="field" type="url" name="actionUrl" maxlength="500" placeholder="https://...">
                </div>
                <div style="grid-column:1/-1;">
                    <div class="field-label">Description</div>
                    <textarea class="field" name="description" maxlength="4000" placeholder="Describe this work or yojna"></textarea>
                </div>
            </div>
            <div class="btn-row">
                <button class="btn primary" type="submit">Add Entry</button>
            </div>
        </form>
    </div>

    <div class="section">
        <h2 class="section-title">Municipal Works</h2>
        <div class="empty" th:if="${workItems == null || workItems.isEmpty()}">No work entries added yet.</div>
        <div class="entry-grid" th:if="${workItems != null && !workItems.isEmpty()}">
            <div class="card" th:each="item : ${workItems}">
                <div class="meta-line" th:text="${'Created: ' + #temporals.format(item.createdAt, 'dd-MMM-yyyy HH:mm')}">Created</div>
                <form method="post" th:action="@{/admin/works-yojna/{id}/update(id=${item.id})}">
                    <div class="form-grid">
                        <div>
                            <div class="field-label">Section</div>
                            <select class="field" name="sectionType" required>
                                <option value="WORK" th:selected="${item.sectionType == 'WORK'}">Municipal Work</option>
                                <option value="YOJNA" th:selected="${item.sectionType == 'YOJNA'}">Government Yojna</option>
                            </select>
                        </div>
                        <div>
                            <div class="field-label">Title</div>
                            <input class="field" type="text" name="title" maxlength="200" th:value="${item.title}" required>
                        </div>
                        <div>
                            <div class="field-label">Status Label</div>
                            <input class="field" type="text" name="statusLabel" maxlength="40" th:value="${item.statusLabel}">
                        </div>
                        <div>
                            <div class="field-label">Meta Line 1</div>
                            <input class="field" type="text" name="metaOne" maxlength="250" th:value="${item.metaOne}">
                        </div>
                        <div>
                            <div class="field-label">Meta Line 2</div>
                            <input class="field" type="text" name="metaTwo" maxlength="250" th:value="${item.metaTwo}">
                        </div>
                        <div>
                            <div class="field-label">Button Text</div>
                            <input class="field" type="text" name="actionText" maxlength="120" th:value="${item.actionText}">
                        </div>
                        <div>
                            <div class="field-label">Button Link</div>
                            <input class="field" type="url" name="actionUrl" maxlength="500" th:value="${item.actionUrl}">
                        </div>
                        <div style="grid-column:1/-1;">
                            <div class="field-label">Description</div>
                            <textarea class="field" name="description" maxlength="4000" th:text="${item.description}"></textarea>
                        </div>
                    </div>
                    <div class="btn-row">
                        <button class="btn primary" type="submit">Update</button>
                    </div>
                </form>
                <form method="post"
                      th:action="@{/admin/works-yojna/{id}/delete(id=${item.id})}"
                      onsubmit="return confirm('Delete this entry?');">
                    <div class="btn-row">
                        <button class="btn danger" type="submit">Delete</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title">Government Yojna</h2>
        <div class="empty" th:if="${yojnaItems == null || yojnaItems.isEmpty()}">No yojna entries added yet.</div>
        <div class="entry-grid" th:if="${yojnaItems != null && !yojnaItems.isEmpty()}">
            <div class="card" th:each="item : ${yojnaItems}">
                <div class="meta-line" th:text="${'Created: ' + #temporals.format(item.createdAt, 'dd-MMM-yyyy HH:mm')}">Created</div>
                <form method="post" th:action="@{/admin/works-yojna/{id}/update(id=${item.id})}">
                    <div class="form-grid">
                        <div>
                            <div class="field-label">Section</div>
                            <select class="field" name="sectionType" required>
                                <option value="WORK" th:selected="${item.sectionType == 'WORK'}">Municipal Work</option>
                                <option value="YOJNA" th:selected="${item.sectionType == 'YOJNA'}">Government Yojna</option>
                            </select>
                        </div>
                        <div>
                            <div class="field-label">Title</div>
                            <input class="field" type="text" name="title" maxlength="200" th:value="${item.title}" required>
                        </div>
                        <div>
                            <div class="field-label">Status Label</div>
                            <input class="field" type="text" name="statusLabel" maxlength="40" th:value="${item.statusLabel}">
                        </div>
                        <div>
                            <div class="field-label">Meta Line 1</div>
                            <input class="field" type="text" name="metaOne" maxlength="250" th:value="${item.metaOne}">
                        </div>
                        <div>
                            <div class="field-label">Meta Line 2</div>
                            <input class="field" type="text" name="metaTwo" maxlength="250" th:value="${item.metaTwo}">
                        </div>
                        <div>
                            <div class="field-label">Button Text</div>
                            <input class="field" type="text" name="actionText" maxlength="120" th:value="${item.actionText}">
                        </div>
                        <div>
                            <div class="field-label">Button Link</div>
                            <input class="field" type="url" name="actionUrl" maxlength="500" th:value="${item.actionUrl}">
                        </div>
                        <div style="grid-column:1/-1;">
                            <div class="field-label">Description</div>
                            <textarea class="field" name="description" maxlength="4000" th:text="${item.description}"></textarea>
                        </div>
                    </div>
                    <div class="btn-row">
                        <button class="btn primary" type="submit">Update</button>
                    </div>
                </form>
                <form method="post"
                      th:action="@{/admin/works-yojna/{id}/delete(id=${item.id})}"
                      onsubmit="return confirm('Delete this entry?');">
                    <div class="btn-row">
                        <button class="btn danger" type="submit">Delete</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
</body>
</html>

